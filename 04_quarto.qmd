# Quarto

## Що таке Quarto
[Quarto](https://quarto.org/) - це науково-технічна видавнича система з відкритим кодом, яка ґрунтується на універсальному конверторі документів [Pandoc](https://pandoc.org/) та використовує мову розмітки [Markdown](https://www.markdownguide.org/). Це універсальний інструмент для тих, хто пише на R, Python, Julia та Observable JavaScript.

За допомогою Quarto можна поєднувати описовий текст і код для створення відформатованих документів, веб-сторінок, постів у блогах, книг тощо.

### Назва Quarto
Розробники Quarto хотіли використати ім'я, яке мало деяке значення в історії видавничої справи. Вибір пав на Quarto (від латинського *quārtō*, скорочено *Qto*, *4t*o або *4º*) - це формат книги або брошури в одну четвертину топографічного листа. На кожній стороні листа при цьому поміщається 4 сторінки книги (8 сторінок на один лист). 

Найраннішим відомим виданням такого формату була Книга Сивіл (англ. *Sibyllenbuch*), що була надрукована Йоганном Гутенбергом у 1452-1453 роках.

[![Quarto](img/quarto2.jpg){#fig-quarto}](https://en.wikipedia.org/wiki/Quarto)

### Можливості Quarto
Quarto являє собою текстовий документ спеціального формату `.qmd`, який можна скомпілювати у різноманітні документи:

- Документи у форматах:
    - [HTML](https://quarto.org/docs/reference/formats/html.html)
    - [PDF](https://quarto.org/docs/reference/formats/pdf.html)
    - [ePub](https://quarto.org/docs/reference/formats/epub.html)
    - [MS Word](https://quarto.org/docs/reference/formats/docx.html)
    - [OpenOffice](https://quarto.org/docs/reference/formats/odt.html)

- Презентації у форматах:
    - [reveal.js](https://quarto.org/docs/presentations/revealjs) (HTML)
    - [PowerPoint](https://quarto.org/docs/presentations/powerpoint.html) (MS Office)
    - [Beamer](https://quarto.org/docs/presentations/beamer.html) (LaTeX/PDF)

- Веб-сторінки:
    - [Practical Deep Learning](https://course.fast.ai/) від fast.ai
    - [nbdev](https://nbdev.fast.ai/) від fast.ai
    - Курс [Julia Workshop for Data Science](https://crsl4.github.io/julia-workshop/)

- Книги, приклади яких можна переглянути за посиланнями:
    - [Python for Data Analysis](https://wesmckinney.com/book/)
    - [R for Data Science](https://r4ds.hadley.nz/)
    - [Visualization Curriculum](https://jjallaire.github.io/visualization-curriculum)
- Інтерактивні документи:
    - [Observable](https://quarto.org/docs/interactive/ojs/examples/penguins.html) reactive JavaScript
    - [Shiny](https://jjallaire.shinyapps.io/diamonds-explorer/) вебфреймворк
    - Інтерактивні віджети [Jupyter](https://quarto.org/docs/interactive/widgets/jupyter.html)

## Початок роботи з Quarto
### Встановлення Quarto
Для роботи з Quarto потрібно:
1. Встановити [інтерфейс командного рядка Quarto](https://quarto.org/docs/download/) (CLI) під актуальну операційну систему (Windows, Linux або Mac OS).

2. Встановити плагін для інтегрованого середовища розробки (IDE). На даний момент підтримуються:
    - [VS Code](https://quarto.org/docs/get-started/hello/vscode.html)
    - [RStudio](https://quarto.org/docs/get-started/hello/rstudio.html)
    - [Jupyter](https://quarto.org/docs/get-started/hello/jupyter.html)

### Робота з проектами
Створити Quarto-проект можна декількома шляхами:

1. За допомогою командного рядка:

```{.bash filename="terminal"}
# веб-сайт
quarto create-project mysite --type website

# блог
quarto create-project myblog --type website:blog

# книга
quarto create-project mybook --type book
```

2. Засобами IDE:

- **VS Code**: *File -> New File -> ...*

![Меню створення Quarto-проекту у VS Code](img/vscode.jpg){#fig-vscode}

- **RStudio**: *File -> New Project… -> New Directory*

![Меню створення Quarto-проекту у RStudio](img/rstudio.jpg){#fig-rstudio width=85%}

### Як працює Quarto
Спочатку Knitr (для R) або Jupyter (для Python або Julia) виконує всі фрагменти коду .qmd-файлу і створює новий markdown (.md) документ, який включає в себе код і всі його результати. Далі .md-файл оброблюється Pandoc для перетворення у різноманітні формати файлів (HTML, PDF, Word тощо).

![Процедура рендерінгу документів в Quarto](img/qmd-jupyter.jpeg){#fig-qmd-jupyter}

### Рендерінг
1. Для рендерінгу документу можна використати кнопку **Render** в VS Code.

![Клавіша рендерінгу документу в VS Code](img/render.jpg){#fig-qmd-render}

2. Рендерінг за допомогою командного рядку:

```{.bash filename="terminal"}
quarto render <input> --to <format>

# Наприклад:
quarto render document.qmd --to docx
```

## Структура документів Quatro
Quatro документи складаються з трьох базових складових:

- YAML-шапки[^yaml]
- Тексту з використанням розмітки Markdown
- Чанків (анг. *chunks*) з кодом

[^yaml]: YAML це рекурсивний акронім YAML Ain't Markup Language («YAML — не мова розмітки»). У назві відображена історія розвитку: на ранніх етапах мова називалася Yet Another Markup Language («Ще одна мова розмітки») і навіть розглядалася як конкурент XML, але пізніше була перейменована з метою акцентувати увагу на даних, а не на розбивці документів.

### YAML-шапка
YAML-шапка знаходиться нагорі документу і відділена трьома дефісами (`---`) зверху та знизу. В ній зберігається мета-інформація документу: назва, дата створення, автор, інформація щодо роботи коду, контенту і процесу рендерінгу.

``` markdown
---
title: "Dracula"
author: "Bram Stoker"
date: "May 26, 1897"
format: 
  html:
    toc: true
    code-fold: true
---
```

### Тексту з використанням розмітки Markdown
Ця частина документу йде одразу після YAML-шапки і складає основну частину документу.

Markdown - це популярна і зручна мова розмітки. Ви непевно зустрічали її в `README.md`-файлах репозиторіїв GitHub, а також у Telegram-повідомленнях.

### Чанки з кодом
Чанки - це блоки, які відділяються від тексту потрійними зворотніми лапками (` анг. *backtick*) на початку та в кінці. У фігурних дужках вказується мова програмування на якій необхідно виконати код. 

```{{python}}
print('Fly, you fools!')
```

Результат чанку за замовчування виводиться одразу після нього, але все це можна налаштувати.

## Основи Markdown
Quarto ґрунтується на Pandoc та використовує різновид markdown в якості базового синтаксису. Pandoc markdown - це розширена та злегка перероблена версія синтаксису markdown.

Markdown — це формат звичайного тексту, який розроблено таким чином, щоб його було легко писати та, що ще важливіше, легко читати.

### Форматування тексту

+-------------------------------------+---------------------------------+
| Синтаксис markdown                  | Результат                       |
+=====================================+=================================+
|     *курсив* та **жирний**          | *курсив* та **жирний**          |
+-------------------------------------+---------------------------------+
|     надрядковий^2^ / підрядковий~2~ | надрядковий^2^ / підрядковий~2~ |
+-------------------------------------+---------------------------------+
|     ~~перекреслення~~               | ~~перекреслення~~               |
+-------------------------------------+---------------------------------+
|     `дослівний код`                 | `дослівний код`                 |
+-------------------------------------+---------------------------------+

### Заголовки

+------------------------+------------------------------------------------+
| Синтаксис markdown     | Результат                                      |
+========================+================================================+
|     # Заголовок 1      | # Header 1 {.heading-output .unnumbered}       |
+------------------------+------------------------------------------------+
|     ## Заголовок 2     | ## Header 2 {.heading-output .unnumbered}      |
+------------------------+------------------------------------------------+
|     ### Заголовок 3    | ### Header 3 {.heading-output .unnumbered}     |
+------------------------+------------------------------------------------+
|     #### Заголовок 4   | #### Header 4 {.heading-output .unnumbered}    |
+------------------------+------------------------------------------------+
|     ##### Заголовок 5  | ##### Header 5 {.heading-output .unnumbered}   |
+------------------------+------------------------------------------------+
|     ###### Заголовок 6 | ###### Header 6 {.heading-output .unnumbered}  |
+------------------------+------------------------------------------------+

### Посилання та рисунки

+----------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
| Синтаксис markdown                                                         | Результат                                                                                          |
+============================================================================+====================================================================================================+
|     [Python](https://python.org)                                           | [Python](https://python.org)                                                                       |
+----------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
|     ![Підпис](img/python-logo.jpg)                                         | ![Підпис](img/python-logo.jpg){fig-alt="Лого Python."}                                             |
+----------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
|     [![Caption](img/python-logo.jpg)](https://www.python.org)              | [![Caption](img/python-logo.jpg)](https://www.python.org)                                          |
+----------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
|     [![Caption](img/python-logo.jpg)](https://www.python.org "Python")     | [![Caption](img/python-logo.jpg "Python"){fig-alt="Лого Python."}](https://www.python.org)         |
+----------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
|     [![](img/python-logo.jpg){fig-alt="Alt text"}](https://www.python.org) | [![](img/python-logo.jpg){fig-alt="A line drawing of an elephant."}](https://www.python.org)       |
+----------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+

### Списки

+-------------------------------------------------+---------------------------------------+
| Синтаксис markdown                              | Результат                             |
+=================================================+=======================================+
|     * невпорядкований список                    | -   невпорядкований список            |
|         + підпункт 1                            |                                       |
|         + підпункт 2                            |     -   підпункт 1                    |
|             - під-підпункт 1                    |                                       |
|                                                 |     -   підпункт 2                    |
|                                                 |                                       |
|                                                 |         -   під-підпункт 1            |
+-------------------------------------------------+---------------------------------------+
|     *   пункт 2                                 | -   пункт 2                           |
|                                                 |                                       |
|         Продовження (відступ 4 інтервали)       |     Продовження (відступ 4 інтервали) |
+-------------------------------------------------+---------------------------------------+
|     1. впорядкований список                     | 1.  впорядкований список              |
|     2. пункт 2                                  |                                       |
|         i) підпункт 1                           | 2.  пункт 2                           |
|              A.  під-підпункт 1                 |                                       |
|                                                 |     i)  підпункт 1                    |
|                                                 |                                       |
|                                                 |         A.  під-підпункт 1            |
+-------------------------------------------------+---------------------------------------+
|     (@)  Список, нумерація якого                | (1) Список, нумерація якого           |
|                                                 |                                       |
|     продовжується після                         | продовжується після                   |
|                                                 |                                       |
|     (@)  переривання                            | (2) переривання                       |
+-------------------------------------------------+---------------------------------------+
|     термін                                      | термін                                |
|     : визначення                                |                                       |
|                                                 | :   визначення                        |
+-------------------------------------------------+---------------------------------------+

### Таблиці

#### Таблиці markdown
##### Синтаксис markdown{.unnumbered} 

    | Зліва | Справа | За замовчуванням | По центру |
    |------:|:-------|------------------|:---------:|
    |   12  |  12    |    12            |    12     |
    |  123  |  123   |   123            |   123     |
    |    1  |    1   |     1            |     1     |

##### Результат{.unnumbered} 

| Зліва | Справа | За замовчуванням | По центру |
|------:|:-------|------------------|:---------:|
|   12  |  12    |    12            |    12     |
|  123  |  123   |   123            |   123     |
|    1  |    1   |     1            |     1     |

Формувати такі таблиці вручну досить складно і незручно. В таких випадках на допомогу приходить [Markdown Tables Generator](https://www.tablesgenerator.com/markdown_tables).

#### Таблиці з Python
Для виводу таблиць за допомогою Python необхідно завантажити пакет `tabulate`:

```{.bash filename="terminal"}
pip install tabulate
```

```{python}
#| label: tbl-character
#| tbl-cap: Персонажі Середзем'я

from IPython.display import Markdown
from tabulate import tabulate
table = [["Bilbo Baggins", "Hobbits", "Male"],
         ["Beren", "Men", "Male"],
         ["Nimrodel", "Elves", "Female"],
         ["Muzgash", "Orc", "Male"]]
Markdown(tabulate(
  table, 
  headers=["Name", "Race", "Sex"]
))
```

Також можна виводити Pandas DataFrame:

```{python}
import pandas as pd
df = pd.DataFrame(data = [[1, 2],[2, 3],[3, 3]], columns = ['v1', 'v2'])
print(df)
```
